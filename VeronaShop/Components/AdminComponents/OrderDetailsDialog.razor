@using VeronaShop.Data.Entites
@using MudBlazor
@inject IDialogService DialogService
@inject Microsoft.Extensions.Localization.IStringLocalizer<SharedResources> L

<MudDialog>
    <DialogContent>
        @if (Order == null)
        {
            <MudText>@L["Loading"]</MudText>
        }
        else
        {
            <MudText Typo="Typo.h6">@L["Order"] @Order.OrderNumber</MudText>
            <MudText>@L["Placed"]: @Order.OrderDate)</MudText>
            <MudText>@L["Paid"]: @(Order.IsPaid ? Order.PaidAt?.ToString("g") : L["No"])</MudText>
            <MudText>@L["Customer"]: @Order.Customer?.Name (@Order.Customer?.Email)</MudText>

            <MudTable Items="Order.OrderProducts" Dense="true" Class="mt-3">
                <HeaderContent>
                    <MudTh>@L["Product"]</MudTh>
                    <MudTh>@L["Size"]</MudTh>
                    <MudTh>@L["Qty"]</MudTh>
                    <MudTh>@L["Unit"]</MudTh>
                    <MudTh>@L["Line"]</MudTh>
                </HeaderContent>
                <RowTemplate>
                    <MudTd>@context.ProductName</MudTd>
                    <MudTd>@(string.IsNullOrEmpty(context.SizeName) ? "-" : context.SizeName)</MudTd>
                    <MudTd>@context.Quantity</MudTd>
                    <MudTd>@context.UnitPrice</MudTd>
                    <MudTd>@(context.UnitPrice * context.Quantity)</MudTd>
                </RowTemplate>
            </MudTable>

            <div class="d-flex justify-end mt-3">
                <MudText Typo="Typo.h6">Total: @Order.TotalAmount</MudText>
            </div>
        }
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Close">Close</MudButton>
    </DialogActions>
</MudDialog>

@code {
    [Parameter] public Orders Order { get; set; }

    void Close()
    {
        try { DialogService.Close(null); } catch { }
    }
}
